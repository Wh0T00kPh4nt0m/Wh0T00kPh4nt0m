Ah, Active Directory — the sprawling bureaucracy of computers, where every mistake is meticulously documented and never quite deleted. This is where enumeration turns from poking services into **mapping power**.

Below are **clean, CPTS-relevant commands** that form a sane AD enumeration workflow. Think *cartography*, not brute force.

---

## crackmapexec (The Swiss Army Knife)

**SMB: verify credentials + basic info**

```bash
crackmapexec smb 10.10.10.0/24 -u user -p password
```

**Enumerate shares:**

```bash
crackmapexec smb 10.10.10.5 -u user -p password --shares
```

**Enumerate users:**

```bash
crackmapexec smb 10.10.10.5 -u user -p password --users
```

**Check admin access (this matters):**

```bash
crackmapexec smb 10.10.10.0/24 -u user -p password --admin
```

---

**LDAP: test bind + domain info**

```bash
crackmapexec ldap 10.10.10.11 -u user -p password
```

**Dump domain users via LDAP:**

```bash
crackmapexec ldap 10.10.10.11 -u user -p password --users
```

**Enumerate groups:**

```bash
crackmapexec ldap 10.10.10.11 -u user -p password --groups
```

---

**WinRM: check remote access**

```bash
crackmapexec winrm 10.10.10.5 -u user -p password
```

If WinRM is open and you’re an admin, congratulations — you’ve reached the “keyboard appears” stage.

---

## BloodHound (Turn Chaos into Graphs)

**Collect data (most common method):**

```bash
bloodhound-python -u user -p password -d example.local -ns 10.10.10.11 -c All
```

**Collection scope notes:**

* `-c All` grabs users, groups, sessions, ACLs
* `-ns` points at the domain controller DNS

**Stealthier / limited collection:**

```bash
bloodhound-python -u user -p password -d example.local -ns 10.10.10.11 -c DCOnly
```

Upload the output to the BloodHound GUI and ask the most important question in AD:

“Who can eventually become Domain Admin, and how lazy is the path?”

---

## ldapsearch (Raw, Powerful, Unforgiving)

**Anonymous bind attempt:**

```bash
ldapsearch -x -H ldap://10.10.10.11 -b "dc=example,dc=local"
```

**Authenticated query:**

```bash
ldapsearch -x -H ldap://10.10.10.11 -D "user@example.local" -w password -b "dc=example,dc=local"
```

**List users only:**

```bash
ldapsearch -x -H ldap://10.10.10.11 -D "user@example.local" -w password \
-b "dc=example,dc=local" "(objectClass=user)" sAMAccountName
```

**Enumerate admin groups:**

```bash
ldapsearch -x -H ldap://10.10.10.11 -D "user@example.local" -w password \
-b "dc=example,dc=local" "(memberOf=CN=Domain Admins,CN=Users,DC=example,DC=local)"
```

ldapsearch is the bedrock beneath BloodHound. When tools disagree, LDAP is the truth.

---

## rpcclient (Old-School, Still Useful)

**Connect anonymously:**

```bash
rpcclient -U "" 10.10.10.5
```

**Connect with credentials:**

```bash
rpcclient -U "user%password" 10.10.10.5
```

Once inside:

**Enumerate users:**

```bash
enumdomusers
```

**Enumerate groups:**

```bash
enumdomgroups
```

**Query a specific user:**

```bash
queryuser 0x1f4
```

rpcclient feels ancient because it is. AD still listens.

---

## The Real AD Skill (This Is the Secret Bit)

Active Directory isn’t hacked by exploits.
It’s *collapsed* by relationships.

* Who logs in where?
* Who can reset whose password?
* Who can write to which object?
* Who hasn’t logged in since 2019 but is still powerful?

BloodHound shows you **possibility**.
Manual verification turns that into **reality**.

From here, the next rung up the ladder is **credential abuse & privilege escalation**: Kerberoasting, ACL abuse, delegation misconfigs. That’s where enumeration stops being informational and starts becoming destiny.
