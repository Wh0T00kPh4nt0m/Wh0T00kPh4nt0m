Right—this is where recon stops being bird-watching and starts being archaeology. Enumeration is careful, iterative, and suspicious of first impressions. Below are **realistic, muscle-memory commands** you’d actually run during labs or an engagement, not decorative syntax.

I’ll flag intent as we go so the *why* stays welded to the *how*.

---

## SMB (Windows’ gossip protocol)

**List shares anonymously:**

```bash
smbclient -L //10.10.10.5 -N
```

`-N` means “no password”. Always try this first. SMB is shockingly chatty.

**Connect to a share:**

```bash
smbclient //10.10.10.5/SHARE -N
```

**Recursive share enumeration (read/write insight):**

```bash
smbmap -H 10.10.10.5
```

**Check access with credentials:**

```bash
smbmap -H 10.10.10.5 -u user -p password
```

**Full SMB enumeration (users, shares, policies):**

```bash
enum4linux-ng 10.10.10.5
```

**Targeted enumeration with creds (CPTS bread-and-butter):**

```bash
crackmapexec smb 10.10.10.5 -u user -p password --shares
```

**Password spraying (carefully, ethically, deliberately):**

```bash
crackmapexec smb 10.10.10.5 -u users.txt -p 'Winter2024!'
```

**Null session check:**

```bash
crackmapexec smb 10.10.10.5 -u '' -p ''
```

---

## FTP (Old, insecure, still everywhere)

**Connect anonymously:**

```bash
ftp 10.10.10.8
```

Username: `anonymous`
Password: anything

**Check for writable directories once inside:**

```bash
put test.txt
```

**Nmap FTP enumeration scripts:**

```bash
nmap -p21 --script ftp-anon,ftp-bounce,ftp-syst 10.10.10.8
```

**Full FTP script sweep:**

```bash
nmap -p21 --script ftp-* 10.10.10.8
```

If FTP lets you upload, your eyebrows should rise slowly and deliberately.

---

## SSH (Not brute force by default—be intentional)

**Standard connection:**

```bash
ssh user@10.10.10.9
```

**Verbose connection (debug auth issues):**

```bash
ssh -vvv user@10.10.10.9
```

**Hydra password attack (only when allowed):**

```bash
hydra -l user -P passwords.txt ssh://10.10.10.9
```

**User list attack:**

```bash
hydra -L users.txt -P passwords.txt ssh://10.10.10.9
```

If SSH allows password auth at all, it’s already had a rough life.

---

## SNMP (The “please tell me everything” service)

**Default community string (classic mistake):**

```bash
snmpwalk -v2c -c public 10.10.10.10
```

**Limit output to system info:**

```bash
snmpwalk -v2c -c public 10.10.10.10 1.3.6.1.2.1.1
```

**Enumerate users, processes, network interfaces:**

```bash
snmp-check 10.10.10.10
```

SNMP leaks topology, usernames, running services—sometimes all before authentication ever happens.

---

## LDAP (AD’s library card catalog)

**Basic LDAP query (anonymous bind):**

```bash
ldapsearch -x -H ldap://10.10.10.11 -b "dc=example,dc=local"
```

**Query users only:**

```bash
ldapsearch -x -H ldap://10.10.10.11 -b "dc=example,dc=local" "(objectClass=user)"
```

**Authenticated bind:**

```bash
ldapsearch -x -H ldap://10.10.10.11 -D "user@example.local" -w password -b "dc=example,dc=local"
```

**Active Directory-focused enumeration:**

```bash
windapsearch.py -d example.local -u user -p password --users
```

**Enumerate groups:**

```bash
windapsearch.py -d example.local -u user -p password --groups
```

LDAP tells you *who exists*, *who matters*, and *who might have forgotten they matter*.

---

## Databases (Credentials often reused—check them)

### MySQL

```bash
mysql -h 10.10.10.12 -u root
```

```bash
mysql -h 10.10.10.12 -u user -p
```

Once inside:

```sql
SHOW DATABASES;
```

---

### PostgreSQL

```bash
psql -h 10.10.10.13 -U postgres
```

```bash
psql -h 10.10.10.13 -U user -d database
```

---

### MSSQL (Impacket)

```bash
mssqlclient.py user:password@10.10.10.14
```

**Windows auth:**

```bash
mssqlclient.py -windows-auth user@10.10.10.14
```

Once inside, always try:

```sql
SELECT @@version;
```

Then check for `xp_cmdshell`. That’s where stories get interesting.

---

## The Meta-Lesson (The Part Most People Skip)

Enumeration isn’t a checklist—it’s a **feedback loop**.

SMB users → reused creds → LDAP bind → database login → shell.
Nothing here is isolated. Every service whispers secrets about the others.

A good operator doesn’t run more tools.
They **run fewer tools with better timing**
