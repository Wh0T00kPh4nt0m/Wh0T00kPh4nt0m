5. Privilege Escalation
Linux Privilege Escalation
SUID Binaries (Old, Reliable, Still Deadly)

You already found them earlier. Now you abuse them deliberately.

find / -perm -4000 -type f 2>/dev/null


Example abuse pattern (conceptual):

find, vim, less, bash, python, perl

Check GTFOBins for exact escalation paths

Mental model:
SUID means “this runs with someone else’s power.” Your job is to steer it.

Writable Services / Binaries

Check service files:

ls -l /etc/systemd/system/


Writable binary example:

ls -l /usr/bin/someservice


If you can modify what root runs, time will do the rest.

Cron Jobs (Scheduled Regret)

List cron jobs:

cat /etc/crontab

ls -la /etc/cron.*


If a cron script is:

writable

runs as root

calls relative paths

…then congratulations, you’ve found time‑based privilege escalation.

Kernel Exploits (Last Resort)

Check kernel version:

uname -a

cat /proc/version


Kernel exploits are:

noisy

risky

version‑specific

They are used when configuration mistakes have failed — not before.

Windows Privilege Escalation
Unquoted Service Paths

Find them (conceptual pattern):

sc qc SomeService


Look for:

C:\Program Files\Vulnerable Service\service.exe


If unquoted and writable anywhere in the path, Windows will happily run your binary instead.

Weak Service Permissions

Check permissions:

icacls "C:\Path\To\Service.exe"


If Users can modify it and it runs as SYSTEM, the system has already agreed to your promotion.

Token Abuse (The Quiet Killer)

First check privileges:

whoami /priv


High‑value flags:

SeImpersonatePrivilege

SeAssignPrimaryTokenPrivilege

This leads to impersonation attacks — extremely common in real environments.

Credential Dumping (Where Allowed)

This is policy‑dependent and context‑sensitive. Conceptually:

LSASS holds secrets

Services cache creds

Memory forgets nothing

Use this knowledge carefully and lawfully.

Active Directory Privilege Escalation
Kerberoasting (Service Accounts)
GetUserSPNs.py example.local/user:password -dc-ip 10.10.10.11


This requests service tickets for SPNs and extracts crackable material.

If a service account password is weak, AD will tell you — eventually.

AS‑REP Roasting (No Pre‑Auth)
GetNPUsers.py example.local/ -usersfile users.txt -dc-ip 10.10.10.11


No authentication required. That alone should make you uneasy.

BloodHound (Paths to Power)

You already collected data. Now you think.

Key questions:

“Shortest path to Domain Admin”

“Who can reset whose password”

“Where does delegation exist”

“What ACLs are writable”

BloodHound doesn’t exploit.
It reveals inevitability.
