# Penetration Testing One‑Page Flowchart (CPTS / CTPS)

This is a **linear-but-looping mental flowchart**. You move forward, but you constantly jump back when new information appears. Print-worthy and exam-friendly.

---

## START

**Scope Known → Target Identified → Begin Recon**

---

## 1. RECON & ATTACK SURFACE MAPPING

**External or Internal?**

* If **External** → Internet-facing IPs, domains, web apps
* If **Internal** → Local network, domain presence, trust boundaries

⬇

**Question:** *What exists?*

⬇

---

## 2. DISCOVERY & ENUMERATION

### Infrastructure / Services

* Hosts alive?
* Ports open?
* Services & versions?
* Auth required or anonymous?

### Web Applications

* Auth flows
* Roles
* Uploads
* APIs
* Error messages

### Active Directory (if domain-joined)

* Users
* Groups
* Computers
* Privileges
* Trust paths

⬇

**Decision:** *Do I have credentials or code execution?*

* **No** → Enumerate deeper / pivot enumeration method
* **Yes** → Initial Access

⬇

---

## 3. INITIAL ACCESS

**Achieve one of:**

* Valid credentials
* Shell / command execution
* Web-to-OS pivot

⬇

**Stabilise Access**

* Stable shell
* Identify user
* Identify host

⬇

---

## 4. POST-EXPLOIT ENUMERATION

**On the compromised system:**

* User privileges
* Groups
* Tokens
* Running services
* Stored credentials
* Network visibility

⬇

**Decision:** *Can I escalate privileges here?*

* **Yes** → Privilege Escalation
* **No** → Lateral Movement Enumeration

⬇

---

## 5. PRIVILEGE ESCALATION

### Local (Host)

* Weak permissions
* Misconfigured services
* Scheduled tasks
* Credential reuse

### Domain (AD)

* Kerberoasting
* AS‑REP roasting
* ACL abuse
* Delegation issues

⬇

**Result:** Higher-privileged user

⬇

---

## 6. LATERAL MOVEMENT

**Question:** *Where else does this identity work?*

* SMB / WinRM / RDP / SSH
* Pass-the-Hash / Ticket
* Service accounts

⬇

**New system accessed?**

* **Yes** → Return to Post‑Exploit Enumeration (Step 4)
* **No** → Re‑evaluate AD / Creds / Services

⬇

---

## 7. DOMAIN CONTROL / HIGH IMPACT

**Possible Outcomes:**

* Domain Admin
* Sensitive data access
* Business logic compromise
* Exam flags

⬇

---

## 8. PERSISTENCE (OPTIONAL BUT EDUCATIONAL)

* New users
* Scheduled tasks
* Service backdoors
* GPO abuse

⬇

---

## 9. OBJECTIVES & PROOF

**Answer:** *So what did this compromise enable?*

⬇

---

## END → REPORTING MINDSET

For every successful path, lock in:

* Entry point
* Why it worked
* How it could be prevented

---

## UNIVERSAL RECOVERY LOOP (WHEN STUCK)

**Enumerate → Hypothesise → Test → Observe → Adjust**

If progress stops, you missed information — not an exploit.

---

**Core Truth:** Methodology beats memory. Calm beats speed. Enumeration beats exploits.

---

# Tooling & Commands Cheat Sheet (Mapped to the Flowchart)

This is **representative, not exhaustive**. Tools are interchangeable; *intent is not*.

---

## 1. Recon & Attack Surface Mapping

### Network / Host Discovery

* `nmap -sn`, `nmap -Pn`
* `masscan` (fast discovery)
* `arp-scan` (internal)

### DNS / Web Recon

* `dig`, `nslookup`
* `dnsenum`, `dnsrecon`
* `ffuf`, `gobuster`, `feroxbuster`
* `whatweb`, `wappalyzer`

---

## 2. Enumeration

### Infrastructure / Services

* **SMB**: `smbclient`, `smbmap`, `enum4linux-ng`, `crackmapexec`
* **FTP**: `ftp`, `nmap --script ftp-*`
* **SSH**: `ssh`, `hydra` (where allowed)
* **SNMP**: `snmpwalk`, `snmp-check`
* **LDAP**: `ldapsearch`, `windapsearch`
* **Databases**: `mysql`, `psql`, `mssqlclient.py`

### Web Applications

* `burpsuite`
* `ffuf`, `wfuzz`
* `nikto`
* Manual testing (auth, roles, logic)

### Active Directory Enumeration

* `crackmapexec smb/ldap/winrm`
* `bloodhound-python`
* `ldapsearch`
* `rpcclient`

---

## 3. Initial Access

### Credentials / Auth

* `crackmapexec`
* `evil-winrm`
* `ssh`, `xfreerdp`

### Web → OS

* File uploads
* Command injection
* Deserialization

### Payloads / Shells

* `nc`, `rlwrap nc`
* `msfvenom` (sparingly)
* Webshells

---

## 4. Post-Exploitation Enumeration

### Linux

* `id`, `groups`
* `sudo -l`
* `ps aux`, `ss -tuln`
* `find / -perm -4000`
* `linpeas.sh`

### Windows

* `whoami /all`
* `net user`, `net localgroup`
* `tasklist /v`
* `sc qc`
* `winPEAS`

---

## 5. Privilege Escalation

### Linux

* SUID binaries
* Writable services
* Cron jobs
* Kernel exploits (last resort)

### Windows

* Unquoted service paths
* Weak service permissions
* Token abuse
* Credential dumping (where allowed)

### AD PrivEsc

* `GetUserSPNs.py` (Kerberoasting)
* `GetNPUsers.py` (AS-REP)
* `bloodhound`

---

## 6. Lateral Movement

* `crackmapexec`
* `evil-winrm`
* `psexec.py`, `wmiexec.py`, `smbexec.py`
* `ssh`
* Pass-the-Hash / Ticket techniques

---

## 7. Persistence (Optional)

* Scheduled tasks
* New users
* Service modification
* GPO abuse

---

## 8. Objectives & Proof

* Data access
* Flags
* Domain Admin proof

---

## Universal Rule

If a tool gives you new information → return to enumeration.
If it doesn’t → stop using it.
